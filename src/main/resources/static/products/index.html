<!DOCTYPE html>
<html>
<head>
  <title>Products</title>
</head>
<body>

<h2>Products</h2>
<a href="create.html">Add Product</a>

<table border="1">
  <thead>
    <tr>
      <th>Name</th>
      <th>Price</th>
      <th>Category</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody id="productTable"></tbody>
</table>

<script>
function loadProducts() {
  fetch("/api/products")
    .then(res => res.json())
    .then(data => {
      const table = document.getElementById("productTable");
      table.innerHTML = "";
      data.forEach(p => {
        table.innerHTML += `
          <tr>
            <td>${p.name}</td>
            <td>${p.price}</td>
            <td>${p.category ?? "-"}</td>
            <td>
              <a href="edit.html?id=${p.id}">Edit</a>
              |
              <button onclick="deleteProduct(${p.id})">Delete</button>
            </td>
          </tr>`;
      });
    });
}

function deleteProduct(id) {
  if (!confirm("Are you sure you want to delete this product?")) return;

  fetch(`/api/products/${id}`, {
    method: "DELETE"
  }).then(() => {
    loadProducts(); // ðŸ”¥ refresh table
  });
}

loadProducts();
</script>

</body>
</html>
